@page "/floodreport/investigation/summary"
@using Microsoft.AspNetCore.Components.Authorization

<PageTitle>@InvestigationPages.Summary.Title</PageTitle>

<h1 class="govuk-heading-xl">@InvestigationPages.Summary.Title</h1>

@if (_saveErrors.Count > 0)
{
    <div class="govuk-error-summary" data-module="govuk-error-summary">
        <div role="alert">
            <h2 class="govuk-error-summary__title">There is a problem</h2>
            <div class="govuk-error-summary__body">
                <ul class="govuk-list govuk-error-summary__list">
                    @foreach (var message in _saveErrors)
                    {
                        <li>@message</li>
                    }
                </ul>
            </div>
        </div>
    </div>
}

<AuthorizeView>
    <NotAuthorized>
        <AccessDenied />
    </NotAuthorized>
    <Authorized>
        <GdsSpinner Show="_isLoading" ShowMessage="true" />

        @if (!_isLoading)
        {
            <InvestigationDtoSummary InvestigationDto="@_investigationDto" IsInternal="@_isInternal" />

            @if (_investigationIsComplete)
            {
                <h2 class="govuk-heading-l">Now send the investigation</h2>
                <p>You are confirming that, to the best of your knowledge, the details you are providing are correct.</p>
                <p>You also agree that the information provided may be used by flood authorities to help with work to better understand flooding.</p>
                <p><button type="button" data-prevent-double-click="true" class="govuk-button" data-module="govuk-button" @onclick="SaveInvestigation">Accept and send</button></p>
            }
        }
    </Authorized>
</AuthorizeView>