using FloodOnlineReportingTool.DataAccess.Models;
using FloodOnlineReportingTool.Public.Models.FloodReport.Create;
using FluentValidation;

namespace FloodOnlineReportingTool.Public.Validators.Create;

public class VulnerabilityValidator : AbstractValidator<Vulnerability>
{
    public VulnerabilityValidator()
    {
        RuleFor(o => o.VulnerablePeopleId)
            .NotEmpty()
            .WithMessage("Select if vulnerable people were affected");

        When(o => o.VulnerablePeopleId == RecordStatusIds.Yes, () =>
        {
            RuleFor(o => o.VulnerablePeopleText)
                .NotEmpty()
                .WithMessage("Enter the number of vulnerable people");

            RuleFor(o => o.VulnerablePeopleNumber)
                .NotEmpty()
                .WithMessage("The number of vulnerable people must be a whole number like 3")
                .InclusiveBetween(1, 25)
                .WithMessage("The number of vulnerable people must be between {From} and {To}")
                .OverridePropertyName(o => o.VulnerablePeopleText)
                .When(o => !string.IsNullOrWhiteSpace(o.VulnerablePeopleText));
        });
    }
}
